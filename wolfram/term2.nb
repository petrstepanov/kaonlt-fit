(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11538,        334]
NotebookOptionsPosition[      9276,        290]
NotebookOutlinePosition[      9608,        305]
CellTagsIndexPosition[      9565,        302]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{"x", "\[Element]", "Reals"}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"Q0", ">", "0"}], "&&", 
   RowBox[{"Q0", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"s0", ">", "0"}], "&&", 
   RowBox[{"s0", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"Q1", ">", "0"}], "&&", 
   RowBox[{"Q1", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"s1", ">", "0"}], "&&", 
   RowBox[{"s1", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"w", ">", "0"}], "&&", 
   RowBox[{"w", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"a", ">", "0"}], "&&", 
   RowBox[{"a", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"mu", ">", "0"}], "&&", 
   RowBox[{"mu", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"n", ">", "0"}], "&&", 
   RowBox[{"n", "\[Element]", "Integers"}]}]}]}], "Input",
 CellChangeTimes->{{3.805593287080927*^9, 3.805593303039323*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"cf835e7c-f71f-470b-968c-8cde33d9b8ab"],

Cell[BoxData[
 RowBox[{"x", "\[Element]", 
  TemplateBox[{},
   "Reals"]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.805596909092911*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"252004c2-67f5-4d20-a997-254f8136cdc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q0", ">", "0"}], "&&", 
  RowBox[{"Q0", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.805596909097735*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"bad1f378-37b4-4804-b904-b9a61fdd7a73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s0", ">", "0"}], "&&", 
  RowBox[{"s0", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.8055969090996857`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"9fb9fb0c-6a66-46cf-9b38-6c375fc7529e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q1", ">", "0"}], "&&", 
  RowBox[{"Q1", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.805596909101419*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"b4f31e8b-387f-425d-954d-7de239e066a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", ">", "0"}], "&&", 
  RowBox[{"s1", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.805596909102882*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"5af8189e-f441-402c-91c6-f8006f5b7953"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", ">", "0"}], "&&", 
  RowBox[{"w", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.805596909104401*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"1d298369-1d6f-4885-a40c-a716f47f138a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", ">", "0"}], "&&", 
  RowBox[{"a", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.805596909105945*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"ff1ba1c4-6207-48f3-866e-28ae6665aeae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mu", ">", "0"}], "&&", 
  RowBox[{"mu", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.805596909107503*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"63c310a4-d330-47e6-8465-cf65d98555a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", ">", "0"}], "&&", 
  RowBox[{"n", "\[Element]", 
   TemplateBox[{},
    "Integers"]}]}]], "Output",
 CellChangeTimes->{3.805593516350213*^9, 3.805595004004663*^9, 
  3.805596861124789*^9, 3.805596909109098*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"4cb1a761-c8e5-4ae1-bd42-9fbddb108ef0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Qsh", "=", 
  RowBox[{"w", "/", "a"}]}]], "Input",
 CellChangeTimes->{{3.805593212588131*^9, 3.8055932173867483`*^9}, {
  3.805593510151923*^9, 3.805593510560158*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"0726d78f-c60e-4d7c-92d9-31b7f6215d47"],

Cell[BoxData[
 FractionBox["w", "a"]], "Output",
 CellChangeTimes->{3.8055935190419703`*^9, 3.805595004077434*^9, 
  3.805596861248208*^9, 3.805596909268227*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"7c553446-4e27-4273-a8e9-962c724ca0ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"term2", "[", "x_", "]"}], "=", 
  RowBox[{
   RowBox[{"mu", "^", "n"}], "*", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "^", 
      RowBox[{"-", "mu"}]}], "/", 
     RowBox[{"Factorial", "[", "n", "]"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"s1", "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "*", "Pi", "*", "n"}], "]"}]}], ")"}]}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "Q0", "-", "Qsh", "-", 
         RowBox[{"n", "*", "Q1"}]}], ")"}], "^", "2"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "n", "*", 
       RowBox[{"s1", "^", "2"}]}], ")"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.805593089046459*^9, 3.805593201556141*^9}, {
  3.805593529939898*^9, 3.805593581266327*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"82dbf895-99f1-4e1e-9042-b2299a48521b"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["e", 
    RowBox[{"-", "mu"}]], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Q0"}], "-", 
         RowBox[{"n", " ", "Q1"}], "-", 
         FractionBox["w", "a"], "+", "x"}], ")"}], "2"], 
      RowBox[{"2", " ", "n", " ", 
       SuperscriptBox["s1", "2"]}]]}]], " ", 
   SuperscriptBox["mu", "n"]}], 
  RowBox[{
   SqrtBox["n"], " ", 
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", "s1", " ", 
   RowBox[{"n", "!"}]}]]], "Output",
 CellChangeTimes->{3.805596909300774*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"5b899476-ae0e-4c78-a326-23c047bdb066"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.805596636203869*^9, 3.805596640876177*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"7d782d8f-5442-4550-8ae5-0638bb1d4848"],

Cell["\<\
Power(mu,n)/(Power(e,mu)*Power(E,
      Power(-Q0 - n*Q1 - w/a + x,2)/(2.*n*Power(s1,2)))*Sqrt(n)*
     Sqrt(2*Pi)*s1*Factorial(n))\
\>", "Output",
 CellChangeTimes->{3.805596909343031*^9},
 CellLabel->
  "Out[13]//CForm=",ExpressionUUID->"1b292059-cfb2-409a-8eb0-4c74051f2c55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"indefIntTerm2", "[", "x_", "]"}], "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"term2", "[", "x", "]"}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.805593629911942*^9, 3.805593632383739*^9}, {
  3.8055949945664988`*^9, 3.805594996400566*^9}, {3.805598105637759*^9, 
  3.805598124193524*^9}},ExpressionUUID->"55a58d8e-23b8-4b54-bc0b-\
ed0eb98de09b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["e", 
     RowBox[{"-", "mu"}]], " ", 
    SuperscriptBox["mu", "n"], " ", 
    RowBox[{"Erf", "[", 
     FractionBox[
      RowBox[{"w", "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"Q0", "+", 
          RowBox[{"n", " ", "Q1"}], "-", "x"}], ")"}]}]}], 
      RowBox[{
       SqrtBox["2"], " ", "a", " ", 
       SqrtBox["n"], " ", "s1"}]], "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"n", "!"}]}]]}]], "Output",
 CellChangeTimes->{3.805596909450109*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"75e82a0f-8d3b-443f-b3ef-8f5496d4b4bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "%", "]"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"0dfdae8d-d538-447e-8ca7-f3c36f3df26f"],

Cell["\<\
-(Power(mu,n)*Erf((w + a*(Q0 + n*Q1 - x))/(Sqrt(2)*a*Sqrt(n)*s1)))/
   (2.*Power(e,mu)*Factorial(n))\
\>", "Output",
 CellChangeTimes->{3.805596909483068*^9},
 CellLabel->
  "Out[15]//CForm=",ExpressionUUID->"c15628b6-4aaa-4adc-9957-6685e2856466"]
}, Open  ]]
},
WindowSize->{720, 793},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1497, 37, 241, "Input",ExpressionUUID->"cf835e7c-f71f-470b-968c-8cde33d9b8ab"],
Cell[2080, 61, 275, 6, 35, "Output",ExpressionUUID->"252004c2-67f5-4d20-a997-254f8136cdc6"],
Cell[2358, 69, 326, 8, 35, "Output",ExpressionUUID->"bad1f378-37b4-4804-b904-b9a61fdd7a73"],
Cell[2687, 79, 328, 8, 35, "Output",ExpressionUUID->"9fb9fb0c-6a66-46cf-9b38-6c375fc7529e"],
Cell[3018, 89, 326, 8, 35, "Output",ExpressionUUID->"b4f31e8b-387f-425d-954d-7de239e066a8"],
Cell[3347, 99, 326, 8, 35, "Output",ExpressionUUID->"5af8189e-f441-402c-91c6-f8006f5b7953"],
Cell[3676, 109, 324, 8, 35, "Output",ExpressionUUID->"1d298369-1d6f-4885-a40c-a716f47f138a"],
Cell[4003, 119, 324, 8, 35, "Output",ExpressionUUID->"ff1ba1c4-6207-48f3-866e-28ae6665aeae"],
Cell[4330, 129, 326, 8, 35, "Output",ExpressionUUID->"63c310a4-d330-47e6-8465-cf65d98555a7"],
Cell[4659, 139, 328, 8, 35, "Output",ExpressionUUID->"4cb1a761-c8e5-4ae1-bd42-9fbddb108ef0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5024, 152, 270, 5, 31, "Input",ExpressionUUID->"0726d78f-c60e-4d7c-92d9-31b7f6215d47"],
Cell[5297, 159, 240, 4, 51, "Output",ExpressionUUID->"7c553446-4e27-4273-a8e9-962c724ca0ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5574, 168, 904, 26, 55, "Input",ExpressionUUID->"82dbf895-99f1-4e1e-9042-b2299a48521b"],
Cell[6481, 196, 732, 23, 82, "Output",ExpressionUUID->"5b899476-ae0e-4c78-a326-23c047bdb066"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7250, 224, 203, 3, 31, "Input",ExpressionUUID->"7d782d8f-5442-4550-8ae5-0638bb1d4848"],
Cell[7456, 229, 288, 7, 88, "Output",ExpressionUUID->"1b292059-cfb2-409a-8eb0-4c74051f2c55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7781, 241, 407, 9, 31, "Input",ExpressionUUID->"55a58d8e-23b8-4b54-bc0b-ed0eb98de09b"],
Cell[8191, 252, 635, 20, 67, "Output",ExpressionUUID->"75e82a0f-8d3b-443f-b3ef-8f5496d4b4bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8863, 277, 137, 2, 31, "Input",ExpressionUUID->"0dfdae8d-d538-447e-8ca7-f3c36f3df26f"],
Cell[9003, 281, 257, 6, 69, "Output",ExpressionUUID->"c15628b6-4aaa-4adc-9957-6685e2856466"]
}, Open  ]]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14048,        420]
NotebookOptionsPosition[     11868,        377]
NotebookOutlinePosition[     12200,        392]
CellTagsIndexPosition[     12157,        389]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{"x", "\[Element]", "Reals"}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"Q0", ">", "0"}], "&&", 
   RowBox[{"Q0", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"s0", ">", "0"}], "&&", 
   RowBox[{"s0", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"Q1", ">", "0"}], "&&", 
   RowBox[{"Q1", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"s1", ">", "0"}], "&&", 
   RowBox[{"s1", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"w", ">", "0"}], "&&", 
   RowBox[{"w", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"a", ">", "0"}], "&&", 
   RowBox[{"a", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"mu", ">", "0"}], "&&", 
   RowBox[{"mu", "\[Element]", "Reals"}]}]}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{
  3.805590678965316*^9, {3.805590762076174*^9, 3.805590765880887*^9}, {
   3.805590797291524*^9, 3.805590948581295*^9}, {3.805591002534213*^9, 
   3.805591016614335*^9}, {3.8055910990424213`*^9, 3.805591100762148*^9}, {
   3.805591194967408*^9, 3.805591196902857*^9}, 3.805591374001245*^9, {
   3.805591785107978*^9, 3.805591785898274*^9}, {3.805592283399517*^9, 
   3.805592284253661*^9}, {3.8055933661991367`*^9, 3.805593374291687*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"4397b109-0bb3-4f2a-a4cc-fa60c874989c"],

Cell[BoxData[
 RowBox[{"x", "\[Element]", 
  TemplateBox[{},
   "Reals"]}]], "Output",
 CellChangeTimes->{3.8055934258284893`*^9, 3.8055947919449177`*^9, 
  3.805596508680835*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"98b0fc1f-e4e5-4a71-af64-a626f72f732c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q0", ">", "0"}], "&&", 
  RowBox[{"Q0", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.8055934258284893`*^9, 3.8055947919449177`*^9, 
  3.8055965087183313`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"fdfcfb0a-3029-406b-9a2c-a55285e750b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s0", ">", "0"}], "&&", 
  RowBox[{"s0", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.8055934258284893`*^9, 3.8055947919449177`*^9, 
  3.805596508720945*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"f1f5c327-d6c8-4e23-b5db-93e0db31c0db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q1", ">", "0"}], "&&", 
  RowBox[{"Q1", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.8055934258284893`*^9, 3.8055947919449177`*^9, 
  3.805596508723112*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"46b41215-cb57-4818-bc0c-1fa60cc8f5c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", ">", "0"}], "&&", 
  RowBox[{"s1", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.8055934258284893`*^9, 3.8055947919449177`*^9, 
  3.805596508724657*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"d421488f-b0be-4660-994f-15ac6f9b102e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", ">", "0"}], "&&", 
  RowBox[{"w", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.8055934258284893`*^9, 3.8055947919449177`*^9, 
  3.80559650872635*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"99902302-caea-4e1a-bd5a-7b0d4c0d9d6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", ">", "0"}], "&&", 
  RowBox[{"a", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.8055934258284893`*^9, 3.8055947919449177`*^9, 
  3.80559650872817*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"57764a87-3375-4697-b4d6-41566ebcee1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mu", ">", "0"}], "&&", 
  RowBox[{"mu", "\[Element]", 
   TemplateBox[{},
    "Reals"]}]}]], "Output",
 CellChangeTimes->{3.8055934258284893`*^9, 3.8055947919449177`*^9, 
  3.8055965087310753`*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"f0814916-9598-4737-a648-1dd968933762"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"term1", "[", "x_", "]"}], "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "w"}], ")"}], "/", "s0"}], "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "*", "Pi"}], "]"}]}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"x", "-", "Q0"}], ")"}]}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", "Q0"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "s0", "*", "s0"}], ")"}]}]}], "]"}]}], "+", 
     RowBox[{"w", "*", 
      RowBox[{"UnitStep", "[", "x", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"x", "-", "Q0"}], ")"}], "*", "a", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"(", 
         RowBox[{"x", "-", "Q0"}], ")"}]}], "]"}]}]}], ")"}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{"-", "mu"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.805590704751519*^9, 3.805590712928198*^9}, 
   3.805590773339547*^9, {3.805590963363783*^9, 3.805590990854333*^9}, {
   3.805591028734908*^9, 3.805591087297728*^9}, {3.805591122819354*^9, 
   3.805591184879233*^9}, 3.805591244498588*^9, {3.8055913080622187`*^9, 
   3.8055913097697477`*^9}, {3.8055913672970543`*^9, 3.805591422228146*^9}, {
   3.805592875644355*^9, 3.8055928824525127`*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"1c7e8927-2796-4f05-9185-7918eea537cb"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", "mu"}]], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Q0", "-", "x"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q0"}], "+", "x"}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["s0", "2"]}]]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "w"}], ")"}]}], 
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", "s0"}]], "+", 
    RowBox[{"a", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "a"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Q0"}], "+", "x"}], ")"}]}]], " ", "w", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q0"}], "+", "x"}], ")"}], " ", 
     RowBox[{"UnitStep", "[", "x", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.805594792017226*^9, 3.805596508854643*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"2650f1e6-f75d-45f1-9345-c6a75945ec47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.805596489423998*^9, 3.805596496511868*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"93e9adb7-5597-47b3-8978-8a4ecfa23d41"],

Cell["\<\
((Power(E,((Q0 - x)*(-Q0 + x))/(2.*Power(s0,2)))*(1 - w))/
      (Sqrt(2*Pi)*s0) + (a*w*(-Q0 + x)*UnitStep(x))/Power(E,a*(-Q0 + x))
     )/Power(E,mu)\
\>", "Output",
 CellChangeTimes->{{3.805596499749118*^9, 3.805596508889908*^9}},
 CellLabel->
  "Out[166]//CForm=",ExpressionUUID->"beda3030-0b75-4187-b927-050983629f4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"defIntTerm1", "[", "x_", "]"}], "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"term1", "[", "x", "]"}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.805591555122081*^9, 3.805591567017365*^9}, {
  3.805592292791291*^9, 3.805592293526794*^9}, {3.80559476710662*^9, 
  3.80559476901433*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"b84f85b1-1eb2-4552-a553-e47aa4da902b"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", "mu"}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "w"}], ")"}], " ", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{"Q0", "-", "x"}], 
       RowBox[{
        SqrtBox["2"], " ", "s0"}]], "]"}]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"Q0", "-", "x"}], ")"}]}]], " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"a", " ", "x"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"a", " ", "Q0"}]}], ")"}]}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q0"}], "+", "x"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"UnitStep", "[", "x", "]"}]}], "a"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.80559479229918*^9, 3.8055965092865868`*^9},
 CellLabel->
  "Out[167]=",ExpressionUUID->"14b3e024-e55a-4472-91d0-e56c417983fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{"%", ",", "ConditionalExpression"}], "]"}]], "Input",
 CellChangeTimes->{3.805592255384479*^9},
 CellLabel->
  "In[168]:=",ExpressionUUID->"028bc358-500c-4c5e-87c6-477645432b4b"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", "mu"}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "w"}], ")"}], " ", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{"Q0", "-", "x"}], 
       RowBox[{
        SqrtBox["2"], " ", "s0"}]], "]"}]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"Q0", "-", "x"}], ")"}]}]], " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"a", " ", "x"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"a", " ", "Q0"}]}], ")"}]}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q0"}], "+", "x"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"UnitStep", "[", "x", "]"}]}], "a"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.805594792334132*^9, 3.805596509323003*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"2e80a775-d7e1-4b62-93ea-a5002e74bbd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.805592998000155*^9, 3.8055929987521*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"6bcdf3a4-486b-4dc7-b2c3-1d29ee0b1702"],

Cell["\<\
(((-1 + w)*Erf((Q0 - x)/(Sqrt(2)*s0)))/2. - 
     (Power(E,a*(Q0 - x))*w*(1 + Power(E,a*x)*(-1 + a*Q0) + 
          a*(-Q0 + x))*UnitStep(x))/a)/Power(E,mu)\
\>", "Output",
 CellChangeTimes->{3.805594792369816*^9, 3.8055965093585157`*^9},
 CellLabel->
  "Out[169]//CForm=",ExpressionUUID->"96aeb70d-83b6-47c5-807e-b80adae9f2ce"]
}, Open  ]]
},
WindowSize->{720, 793},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1771, 41, 241, "Input",ExpressionUUID->"4397b109-0bb3-4f2a-a4cc-fa60c874989c"],
Cell[2354, 65, 262, 7, 35, "Output",ExpressionUUID->"98b0fc1f-e4e5-4a71-af64-a626f72f732c"],
Cell[2619, 74, 315, 9, 35, "Output",ExpressionUUID->"fdfcfb0a-3029-406b-9a2c-a55285e750b5"],
Cell[2937, 85, 313, 9, 35, "Output",ExpressionUUID->"f1f5c327-d6c8-4e23-b5db-93e0db31c0db"],
Cell[3253, 96, 313, 9, 35, "Output",ExpressionUUID->"46b41215-cb57-4818-bc0c-1fa60cc8f5c3"],
Cell[3569, 107, 313, 9, 35, "Output",ExpressionUUID->"d421488f-b0be-4660-994f-15ac6f9b102e"],
Cell[3885, 118, 310, 9, 35, "Output",ExpressionUUID->"99902302-caea-4e1a-bd5a-7b0d4c0d9d6c"],
Cell[4198, 129, 310, 9, 35, "Output",ExpressionUUID->"57764a87-3375-4697-b4d6-41566ebcee1f"],
Cell[4511, 140, 315, 9, 35, "Output",ExpressionUUID->"f0814916-9598-4737-a648-1dd968933762"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4863, 154, 1519, 41, 78, "Input",ExpressionUUID->"1c7e8927-2796-4f05-9185-7918eea537cb"],
Cell[6385, 197, 1134, 36, 82, "Output",ExpressionUUID->"2650f1e6-f75d-45f1-9345-c6a75945ec47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7556, 238, 207, 4, 31, "Input",ExpressionUUID->"93e9adb7-5597-47b3-8978-8a4ecfa23d41"],
Cell[7766, 244, 332, 7, 88, "Output",ExpressionUUID->"beda3030-0b75-4187-b927-050983629f4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8135, 256, 427, 10, 31, "Input",ExpressionUUID->"b84f85b1-1eb2-4552-a553-e47aa4da902b"],
Cell[8565, 268, 1219, 38, 175, "Output",ExpressionUUID->"14b3e024-e55a-4472-91d0-e56c417983fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9821, 311, 227, 5, 31, "Input",ExpressionUUID->"028bc358-500c-4c5e-87c6-477645432b4b"],
Cell[10051, 318, 1218, 38, 118, "Output",ExpressionUUID->"2e80a775-d7e1-4b62-93ea-a5002e74bbd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11306, 361, 205, 4, 31, "Input",ExpressionUUID->"6bcdf3a4-486b-4dc7-b2c3-1d29ee0b1702"],
Cell[11514, 367, 338, 7, 88, "Output",ExpressionUUID->"96aeb70d-83b6-47c5-807e-b80adae9f2ce"]
}, Open  ]]
}
]
*)

